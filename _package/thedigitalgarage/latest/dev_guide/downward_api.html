<!DOCTYPE html>
<!--[if IE 8]> <html class="ie8"> <![endif]-->
<!--[if IE 9]> <html class="ie9"> <![endif]-->
<!--[if gt IE 9]><!-->
<html>
<!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta content="IE=edge" http-equiv="X-UA-Compatible">
  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <title>Digital Garage | Developer Guide | Downward API</title>
  <link href="http://assets-digitalgarage-infra.apps.thedigitalgarage.io/stylesheets/subdomain.css" rel="stylesheet" type="text/css">
  <link href="http://assets-digitalgarage-infra.apps.thedigitalgarage.io/stylesheets/docs.css" rel="stylesheet" type="text/css"/>
  <link href="http://assets-digitalgarage-infra.apps.thedigitalgarage.io/stylesheets/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  <!--
  <link href="https://raw.githubusercontent.com/thedigitalgarage/origin-web-console/master/extensions/thedigitalgarage/css/main.css" rel="stylesheet" type="text/css">
  -->
  <link href="http://assets-digitalgarage-infra.apps.thedigitalgarage.io/images/favicon.png" rel="apple-touch-icon-precomposed" type="image/png">
  <link href="http://assets-digitalgarage-infra.apps.thedigitalgarage.io/images/favicon.png" rel="shortcut icon" type="text/css">
  <!--[if IE]><link rel="shortcut icon" href="https://assets.openshift.net/content/subdomain/favicon.ico"><![endif]-->
  <!-- or, set /favicon.ico for IE10 win -->
  <meta content="Digital Garage Documentation" name="application-name">
  <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!--[if lt IE 9]>
    <script src="https://assets.openshift.net/content/html5shiv.js" type="text/javascript"></script>
    <script src="https://assets.openshift.net/content/respond.js" type="text/javascript"></script>
    <link href="https://assets.openshift.net/content/vendor/respond-js/respond-proxy.html" id="respond-proxy" rel="respond-proxy">
    <link href="/_images/respond.proxy.gif" id="respond-redirect" rel="respond-redirect">
    <script src="/_javascripts/respond.proxy.js" type="text/javascript"></script>
  <![endif]-->
  <script src="https://assets.openshift.net/content/modernizr.js" type="text/javascript"></script>
  <script src="https://assets.openshift.net/content/subdomain.js" type="text/javascript"></script>
  <script src="/_javascripts/bootstrap-offcanvas.js" type="text/javascript"></script>
  <script>
    (function(i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
        }, i[r].l = 1 * new Date();
        a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
    })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');

    ga('create', 'UA-84210257-3', 'auto');
    ga('send', 'pageview');
</script>
</head>
<body>
  <div class="navbar navbar-default navbar-digital-garage" role="navigation">
  <div class="navbar-header">
    <a class="navbar-brand digital-garage" href="/"></a>
  </div>
</div>
  <div class="container">
    <p class="toggle-nav visible-xs pull-left">
      <button class="btn btn-default btn-sm" type="button" data-toggle="offcanvas">Toggle nav</button>
    </p>
    <ol class="breadcrumb">
      <li class="sitename">
        <a href="../../welcome/index.html">Documentation</a>
      </li>
      <li class="hidden-xs active">
        <a href="../welcome/index.html">Digital Garage Discovery</a>
      </li>
      <li class="hidden-xs active">
        <a href="../dev_guide/index.html">Developer Guide</a>
      </li>
      
      <li class="hidden-xs active">
        Downward API
      </li>
    </ol>
    <div class="row row-offcanvas row-offcanvas-left">
      <div class="col-xs-8 col-sm-3 col-md-3 sidebar sidebar-offcanvas">
        <div class="row-fluid">
          
<script>
  (function() {
    var cx = '013769182564158614814:e-dp46b51vk';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//cse.google.com/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<gcse:search></gcse:search>

        </div>
        <ul class="nav nav-sidebar">
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup0">
        <span id="tgSpan0" class="fa fa-angle-right"></span>About
      </a>
      <ul id="topicGroup0" class="collapse  list-unstyled">
            <li><a class="" href="../welcome/index.html">Welcome</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup1">
        <span id="tgSpan1" class="fa fa-angle-right"></span>Getting Started
      </a>
      <ul id="topicGroup1" class="collapse  list-unstyled">
            <li><a class="" href="../getting_started/index.html">Overview</a></li>
            <li><a class="" href="../getting_started/basic_walkthrough.html">Basic Walkthrough</a></li>
            <li><a class="" href="../getting_started/beyond_the_basics.html">Beyond the Basics</a></li>
            <li><a class="" href="../getting_started/developers_console.html">Web Console Walkthrough</a></li>
            <li><a class="" href="../getting_started/developers_cli.html">Command-Line Walkthrough</a></li>
            <li><a class="" href="../getting_started/devpreview_faq.html">Developer Preview FAQ</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup2">
        <span id="tgSpan2" class="fa fa-angle-right"></span>Architecture
      </a>
      <ul id="topicGroup2" class="collapse  list-unstyled">
            <li><a class="" href="../architecture/index.html">Overview</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-2-1">
                <span id="sgSpan-2-1" class="fa fa-caret-right"></span>&nbsp;Core Concepts
              </a>
              <ul id="topicSubGroup-2-1" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../architecture/core_concepts/index.html">Overview</a></li>

                  <li><a class="" href="../architecture/core_concepts/containers_and_images.html">Containers and Images</a></li>

                  <li><a class="" href="../architecture/core_concepts/containers_and_images.html">Images</a></li>

                  <li><a class="" href="../architecture/core_concepts/pods_and_services.html">Pods and Services</a></li>

                  <li><a class="" href="../architecture/core_concepts/projects_and_users.html">Projects and Users</a></li>

                  <li><a class="" href="../architecture/core_concepts/builds_and_image_streams.html">Builds and Image Streams</a></li>

                  <li><a class="" href="../architecture/core_concepts/deployments.html">Deployments</a></li>

                  <li><a class="" href="../architecture/core_concepts/routes.html">Routes</a></li>

                  <li><a class="" href="../architecture/core_concepts/templates.html">Templates</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-2-2">
                <span id="sgSpan-2-2" class="fa fa-caret-right"></span>&nbsp;Additional Concepts
              </a>
              <ul id="topicSubGroup-2-2" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../architecture/additional_concepts/overview.html">Overview</a></li>

                  <li><a class="" href="../architecture/additional_concepts/networking.html">Networking</a></li>

                  <li><a class="" href="../architecture/additional_concepts/remote_commands.html">Remote Commands</a></li>

                  <li><a class="" href="../architecture/additional_concepts/port_forwarding.html">Port Forwarding</a></li>

                  <li><a class="" href="../architecture/additional_concepts/scm.html">Source Control Management</a></li>
              </ul>
            </li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup3">
        <span id="tgSpan3" class="fa fa-angle-right"></span>CLI Reference
      </a>
      <ul id="topicGroup3" class="collapse  list-unstyled">
            <li><a class="" href="../cli_reference/index.html">Overview</a></li>
            <li><a class="" href="../cli_reference/cli_by_example_content.html">CLI by example</a></li>
            <li><a class="" href="../cli_reference/get_started_cli.html">Get Started with the CLI</a></li>
            <li><a class="" href="../cli_reference/manage_cli_profiles.html">Managing CLI Profiles</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup4">
        <span id="tgSpan4" class="fa fa-angle-down"></span>Developer Guide
      </a>
      <ul id="topicGroup4" class="collapse in list-unstyled">
            <li><a class="" href="../dev_guide/index.html">Overview</a></li>
            <li><a class="" href="../dev_guide/application_lifecycle.html">Application Life Cycle Examples</a></li>
            <li><a class="" href="../dev_guide/authentication.html">Authentication</a></li>
            <li><a class="" href="../dev_guide/projects.html">Projects</a></li>
            <li><a class="" href="../dev_guide/new_app.html">Creating New Applications</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-5">
                <span id="sgSpan-4-5" class="fa fa-caret-right"></span>&nbsp;Migrating Applications
              </a>
              <ul id="topicSubGroup-4-5" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../dev_guide/migrating_applications/index.html">Overview</a></li>

                  <li><a class="" href="../dev_guide/migrating_applications/database_applications.html">Database Applications</a></li>

                  <li><a class="" href="../dev_guide/migrating_applications/web_framework_applications.html">Web Framework Applications</a></li>

                  <li><a class="" href="../dev_guide/migrating_applications/quickstart_examples.html">QuickStart Examples</a></li>

                  <li><a class="" href="../dev_guide/migrating_applications/continuous_integration_and_deployment.html">Continuous Integration and Deployment</a></li>

                  <li><a class="" href="../dev_guide/migrating_applications/web_hooks_action_hooks.html">Webhooks and Action Hooks</a></li>

                  <li><a class="" href="../dev_guide/migrating_applications/S2I_tool.html">S2I Tool</a></li>

                  <li><a class="" href="../dev_guide/migrating_applications/support_guide.html">Support Guide</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-4-6">
                <span id="sgSpan-4-6" class="fa fa-caret-right"></span>&nbsp;Application Tutorials
              </a>
              <ul id="topicSubGroup-4-6" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../dev_guide/app_tutorials/index.html">Overview</a></li>

                  <li><a class="" href="../dev_guide/app_tutorials/quickstarts.html">Quickstart Templates</a></li>

                  <li><a class="" href="../dev_guide/app_tutorials/ruby_on_rails.html">Ruby on Rails</a></li>

                  <li><a class="" href="../dev_guide/app_tutorials/maven_tutorial.html">Setting Up a Nexus Mirror</a></li>
              </ul>
            </li>
            <li><a class="" href="../dev_guide/ssh_environment.html">Opening a Remote Shell to Containers</a></li>
            <li><a class="" href="../dev_guide/templates.html">Templates</a></li>
            <li><a class="" href="../dev_guide/service_accounts.html">Service Accounts</a></li>
            <li><a class="" href="../dev_guide/builds.html">Builds</a></li>
            <li><a class="" href="../dev_guide/managing_images.html">Managing Images</a></li>
            <li><a class="" href="../dev_guide/compute_resources.html">Quotas and Limit Ranges</a></li>
            <li><a class="" href="../dev_guide/deployments.html">Deployments</a></li>
            <li><a class="" href="../dev_guide/getting_traffic_into_cluster.html">Getting Traffic Into The Cluster</a></li>
            <li><a class="" href="../dev_guide/routes.html">Routes</a></li>
            <li><a class="" href="../dev_guide/integrating_external_services.html">Integrating External Services</a></li>
            <li><a class="" href="../dev_guide/secrets.html">Secrets</a></li>
            <li><a class="" href="../dev_guide/configmaps.html">ConfigMaps</a></li>
            <li><a class="" href="../dev_guide/daemonsets.html">Using Daemonsets</a></li>
            <li><a class="" href="../dev_guide/pod_autoscaling.html">Pod Autoscaling</a></li>
            <li><a class="" href="../dev_guide/volumes.html">Managing Volumes</a></li>
            <li><a class="" href="../dev_guide/persistent_volumes.html">Using Persistent Volumes</a></li>
            <li><a class="" href="../dev_guide/executing_remote_commands.html">Executing Remote Commands</a></li>
            <li><a class="" href="../dev_guide/copy_files_to_container.html">Copying Files</a></li>
            <li><a class="" href="../dev_guide/port_forwarding.html">Port Forwarding</a></li>
            <li><a class="" href="../dev_guide/shared_memory.html">Shared Memory</a></li>
            <li><a class="" href="../dev_guide/application_health.html">Application Health</a></li>
            <li><a class="" href="../dev_guide/events.html">Events</a></li>
            <li><a class=" active" href="../dev_guide/downward_api.html">Downward API</a></li>
            <li><a class="" href="../dev_guide/environment_variables.html">Managing Environment Variables</a></li>
            <li><a class="" href="../dev_guide/jobs.html">Jobs</a></li>
            <li><a class="" href="../dev_guide/scheduled_jobs.html">Scheduled Jobs</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup5">
        <span id="tgSpan5" class="fa fa-angle-right"></span>Creating Images
      </a>
      <ul id="topicGroup5" class="collapse  list-unstyled">
            <li><a class="" href="../creating_images/index.html">Overview</a></li>
            <li><a class="" href="../creating_images/guidelines.html">Guidelines</a></li>
            <li><a class="" href="../creating_images/metadata.html">Image Metadata</a></li>
            <li><a class="" href="../creating_images/s2i.html">S2I Requirements</a></li>
            <li><a class="" href="../creating_images/s2i_testing.html">Testing S2I Images</a></li>
            <li><a class="" href="../creating_images/custom.html">Custom Builder</a></li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup6">
        <span id="tgSpan6" class="fa fa-angle-right"></span>Using Images
      </a>
      <ul id="topicGroup6" class="collapse  list-unstyled">
            <li><a class="" href="../using_images/index.html">Overview</a></li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-6-1">
                <span id="sgSpan-6-1" class="fa fa-caret-right"></span>&nbsp;Source-to-Image (S2I)
              </a>
              <ul id="topicSubGroup-6-1" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../using_images/s2i_images/index.html">Overview</a></li>

                  <li><a class="" href="../using_images/s2i_images/customizing_s2i_images.html">Customizing S2I images</a></li>

                  <li><a class="" href="../using_images/s2i_images/dot_net_core.html">.NET Core</a></li>

                  <li><a class="" href="../using_images/s2i_images/nodejs.html">Node.js</a></li>

                  <li><a class="" href="../using_images/s2i_images/perl.html">Perl</a></li>

                  <li><a class="" href="../using_images/s2i_images/php.html">PHP</a></li>

                  <li><a class="" href="../using_images/s2i_images/python.html">Python</a></li>

                  <li><a class="" href="../using_images/s2i_images/java.html">Java</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-6-2">
                <span id="sgSpan-6-2" class="fa fa-caret-right"></span>&nbsp;Database Images
              </a>
              <ul id="topicSubGroup-6-2" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../using_images/db_images/index.html">Overview</a></li>

                  <li><a class="" href="../using_images/db_images/mysql.html">MySQL</a></li>

                  <li><a class="" href="../using_images/db_images/postgresql.html">PostgreSQL</a></li>

                  <li><a class="" href="../using_images/db_images/mongodb.html">MongoDB</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-6-3">
                <span id="sgSpan-6-3" class="fa fa-caret-right"></span>&nbsp;Docker Images
              </a>
              <ul id="topicSubGroup-6-3" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../using_images/docker_images/index.html">Overview</a></li>
              </ul>
            </li>
            <li class="nav-header">
              <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicSubGroup-6-4">
                <span id="sgSpan-6-4" class="fa fa-caret-right"></span>&nbsp;Other Images
              </a>
              <ul id="topicSubGroup-6-4" class="nav-tertiary list-unstyled collapse">

                  <li><a class="" href="../using_images/other_images/index.html">Overview</a></li>

                  <li><a class="" href="../using_images/other_images/jenkins.html">Jenkins</a></li>
              </ul>
            </li>
      </ul>
    </li>
    <li class="nav-header">
      <a class="" href="javascript:void(0);" data-toggle="collapse" data-target="#topicGroup7">
        <span id="tgSpan7" class="fa fa-angle-right"></span>REST API Reference
      </a>
      <ul id="topicGroup7" class="collapse  list-unstyled">
            <li><a class="" href="../rest_api/index.html">Overview</a></li>
            <li><a class="" href="../rest_api/openshift_v1.html">OpenShift v1</a></li>
            <li><a class="" href="../rest_api/kubernetes_v1.html">Kubernetes v1</a></li>
      </ul>
    </li>
</ul>
      </div>
      <div class="col-xs-12 col-sm-9 col-md-9 main">
        <div class="page-header">
          <h2>Downward API</h2>
        </div>
        <div id="preamble">
<div class="sectionbody">
<div id="toc" class="toc">
<div id="toctitle" class="title"></div>
<ul class="sectlevel1">
<li><a href="#overview">Overview</a></li>
<li><a href="#selecting-fields">Selecting Fields</a></li>
<li><a href="#dapi-consuming-container-values">Consuming the Container Values Using the Downward API</a>
<ul class="sectlevel2">
<li><a href="#dapi-values-using-environment-variables">Using Environment Variables</a></li>
<li><a href="#dapi-values-using-volume-plugin">Using the Volume Plug-in</a></li>
</ul>
</li>
<li><a href="#dapi-consuming-container-resources">Consuming Container Resources Using the Downward API</a>
<ul class="sectlevel2">
<li><a href="#dapi-resources-environment-variables">Using Environment Variables</a></li>
<li><a href="#dapi-resources-volume-plugin">Using the Volume Plug-in</a></li>
</ul>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="overview"><a class="anchor" href="#overview"></a>Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The downward API is a mechanism that allows containers to consume information
about API objects without coupling to Digital Garage. Such information includes
the pod&#8217;s name, namespace, and resource values. Containers can consume
information from the downward API using environment variables or a volume
plug-in.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="selecting-fields"><a class="anchor" href="#selecting-fields"></a>Selecting Fields</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Fields within the pod are selected using the <code><strong>FieldRef</strong></code> API type. <code><strong>FieldRef</strong></code>
has two fields:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Field</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>fieldPath</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The path of the field to select, relative to the pod.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>apiVersion</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The API version to interpret the <code><strong>fieldPath</strong></code> selector within.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Currently, the valid selectors in the v1 API include:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Selector</th>
<th class="tableblock halign-left valign-top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>metadata.name</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pod&#8217;s name. This is supported in both environment variables and volumes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>metadata.namespace</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pod&#8217;s namespace.This is supported in both environment variables and volumes.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>metadata.labels</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pod&#8217;s labels. This is only supported in volumes and not in environment variables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>metadata.annotations</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pod&#8217;s annotations. This is only supported in volumes and not in environment variables.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code><strong>status.podIP</strong></code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">The pod&#8217;s IP. This is only supported in environment variables and not volumes.</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The <code><strong>apiVersion</strong></code> field, if not specified, defaults to the API version of the
enclosing pod template.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dapi-consuming-container-values"><a class="anchor" href="#dapi-consuming-container-values"></a>Consuming the Container Values Using the Downward API</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="dapi-values-using-environment-variables"><a class="anchor" href="#dapi-values-using-environment-variables"></a>Using Environment Variables</h3>
<div class="paragraph">
<p>One mechanism for consuming the downward API is using a container&#8217;s environment
variables. The <code><strong>EnvVar</strong></code> type&#8217;s <code><strong>valueFrom</strong></code> field (of type <code><strong>EnvVarSource</strong></code>)
is used to specify that the variable&#8217;s value should come from a <code><strong>FieldRef</strong></code>
source instead of the literal value specified by the <code><strong>value</strong></code> field. In the
future, additional sources may be supported; currently the source&#8217;s <code><strong>fieldRef</strong></code>
field is used to select a field from the downward API.</p>
</div>
<div class="paragraph">
<p>Only constant attributes of the pod can be consumed this way, as environment
variables cannot be updated once a process is started in a way that allows the
process to be notified that the value of a variable has changed. The fields
supported using environment variables are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pod name</p>
</li>
<li>
<p>Pod namespace</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a <code><strong><em>pod.json</em></strong></code> file:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dapi-env-test-pod</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: env-test-container</span></span>
      <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">gcr.io/google_containers/busybox</span></span>
      <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">[ &quot;/bin/sh&quot;, &quot;-c&quot;, &quot;env&quot; ]</span></span>
      <span style="color:#606">env</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: MY_POD_NAME</span></span>
          <span style="color:#606">valueFrom</span>:
            <span style="color:#606">fieldRef</span>:
              <span style="color:#606">fieldPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">metadata.name</span></span>
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: MY_POD_NAMESPACE</span></span>
          <span style="color:#606">valueFrom</span>:
            <span style="color:#606">fieldRef</span>:
              <span style="color:#606">fieldPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">metadata.namespace</span></span>
  <span style="color:#606">restartPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Never</span></span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Create the pod from the <code><strong><em>pod.json</em></strong></code> file:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ oc create -f pod.json</pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Check the container&#8217;s logs for the <code><strong>MY_POD_NAME</strong></code> and <code><strong>MY_POD_NAMESPACE</strong></code>
values:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ oc logs -p dapi-env-test-pod</pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="dapi-values-using-volume-plugin"><a class="anchor" href="#dapi-values-using-volume-plugin"></a>Using the Volume Plug-in</h3>
<div class="paragraph">
<p>Another mechanism for consuming the downward API is using a volume plug-in. The
downward API volume plug-in creates a volume with configured fields projected
into files. The <code><strong>metadata</strong></code> field of the <code><strong>VolumeSource</strong></code> API object is used to
configure this volume. The plug-in supports the following fields:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Pod name</p>
</li>
<li>
<p>Pod namespace</p>
</li>
<li>
<p>Pod annotations</p>
</li>
<li>
<p>Pod labels</p>
</li>
</ul>
</div>
<div class="exampleblock">
<div class="title">Example 1. Downward API Volume Plug-in Configuration</div>
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">spec</span>:
  <span style="color:#606">volumes</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: podinfo</span></span>
      <span style="color:#606">metadata</span>: <i class="conum" data-value="1"></i><b>(1)</b>
        <span style="color:#606">items</span>:  <i class="conum" data-value="2"></i><b>(2)</b>
          - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;labels&quot; </span></span><i class="conum" data-value="3"></i><b>(3)</b>
            <span style="color:#606">fieldRef</span>:
              <span style="color:#606">fieldPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">metadata.labels </span></span> <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code><strong>metadata</strong></code> field of the volume source configures the downward API
volume.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code><strong>items</strong></code> field holds a list of fields to project into the volume.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>The name of the file to project the field into.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>The selector of the field to project.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Create a <code><strong><em>volume-pod.json</em></strong></code> file:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yaml"><span style="color:#606">kind</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Pod</span></span>
<span style="color:#606">apiVersion</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">v1</span></span>
<span style="color:#606">metadata</span>:
  <span style="color:#606">labels</span>:
    <span style="color:#606">zone</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">us-east-coast</span></span>
    <span style="color:#606">cluster</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">downward-api-test-cluster1</span></span>
    <span style="color:#606">rack</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">rack-123</span></span>
  <span style="color:#606">name</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">dapi-volume-test-pod</span></span>
  <span style="color:#606">annotations</span>:
    <span style="color:#606">annotation1</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">345</span></span>
    <span style="color:#606">annotation2</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">456</span></span>
<span style="color:#606">spec</span>:
  <span style="color:#606">containers</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: volume-test-container</span></span>
      <span style="color:#606">image</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">gcr.io/google_containers/busybox</span></span>
      <span style="color:#606">command</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">[&quot;sh&quot;, &quot;-c&quot;, &quot;cat /etc/labels /etc/annotations&quot;]</span></span>
      <span style="color:#606">volumeMounts</span>:
        - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: podinfo</span></span>
          <span style="color:#606">mountPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">/etc</span></span>
          <span style="color:#606">readOnly</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">false</span></span>
  <span style="color:#606">volumes</span>:
    - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: podinfo</span></span>
      <span style="color:#606">metadata</span>:
        <span style="color:#606">items</span>:
          - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;labels&quot;</span></span>
            <span style="color:#606">fieldRef</span>:
              <span style="color:#606">fieldPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">metadata.labels</span></span>
          - <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">name: &quot;annotations&quot;</span></span>
            <span style="color:#606">fieldRef</span>:
              <span style="color:#606">fieldPath</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">metadata.annotations</span></span>
  <span style="color:#606">restartPolicy</span>: <span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#D20">Never</span></span></code></pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Create the pod from the <code><strong><em>volume-pod.json</em></strong></code> file:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ oc create -f volume-pod.json</pre>
</div>
</div>
</div>
</div>
</li>
<li>
<p>Check the container&#8217;s logs and verify the presence of the configured fields:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ oc logs -p dapi-volume-test-pod
cluster=downward-api-test-cluster1
rack=rack-123
zone=us-east-coast
annotation1=345
annotation2=456
kubernetes.io/config.source=api</pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="dapi-consuming-container-resources"><a class="anchor" href="#dapi-consuming-container-resources"></a>Consuming Container Resources Using the Downward API</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When creating pods, you can use the downward API to inject information about
computing resource requests and limits so that image and application authors can
correctly create an image for specific environments.</p>
</div>
<div class="paragraph">
<p>You can do this using both the <a href="#dapi-resources-environment-variables">environment
variable</a> and <a href="#dapi-values-using-volume-plugin">volume plug-in</a> methods.</p>
</div>
<div class="sect2">
<h3 id="dapi-resources-environment-variables"><a class="anchor" href="#dapi-resources-environment-variables"></a>Using Environment Variables</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When creating a pod configuration, specify environment variables that
correspond to the contents of the <code><strong>resources</strong></code> field in the <code><strong>spec.container</strong></code>
field:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>...
spec:
  containers:
    - name: test-container
      image: gcr.io/google_containers/busybox:1.24
      command: [ "/bin/sh", "-c", "env" ]
      resources:
        requests:
          memory: "32Mi"
          cpu: "125m"
        limits:
          memory: "64Mi"
          cpu: "250m"
      env:
        - name: MY_CPU_REQUEST
          valueFrom:
            resourceFieldRef:
              resource: requests.cpu
        - name: MY_CPU_LIMIT
          valueFrom:
            resourceFieldRef:
              resource: limits.cpu
        - name: MY_MEM_REQUEST
          valueFrom:
            resourceFieldRef:
              resource: requests.memory
        - name: MY_MEM_LIMIT
          valueFrom:
            resourceFieldRef:
              resource: limits.memory
...</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the resource limits are not included in the container configuration, the
downward API defaults to the node&#8217;s CPU and memory allocatable values.</p>
</div>
</li>
<li>
<p>Create the pod from the <code><strong><em>pod.json</em></strong></code> file:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ oc create -f pod.json</pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="dapi-resources-volume-plugin"><a class="anchor" href="#dapi-resources-volume-plugin"></a>Using the Volume Plug-in</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When creating a pod configuration, use the <code><strong>spec.volumes.downwardAPI.items</strong></code>
field to describe the desired resources that correspond to the
<code><strong>spec.resources</strong></code> field:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>....
spec:
  containers:
    - name: client-container
      image: gcr.io/google_containers/busybox:1.24
      command: ["sh", "-c", "while true; do echo; if [[ -e /etc/cpu_limit ]]; then cat /etc/cpu_limit; fi; if [[ -e /etc/cpu_request ]]; then cat /etc/cpu_request; fi; if [[ -e /etc/mem_limit ]]; then cat /etc/mem_limit; fi; if [[ -e /etc/mem_request ]]; then cat /etc/mem_request; fi; sleep 5; done"]
      resources:
        requests:
          memory: "32Mi"
          cpu: "125m"
        limits:
          memory: "64Mi"
          cpu: "250m"
      volumeMounts:
        - name: podinfo
          mountPath: /etc
          readOnly: false
  volumes:
    - name: podinfo
      downwardAPI:
        items:
          - path: "cpu_limit"
            resourceFieldRef:
              containerName: client-container
              resource: limits.cpu
          - path: "cpu_request"
            resourceFieldRef:
              containerName: client-container
              resource: requests.cpu
          - path: "mem_limit"
            resourceFieldRef:
              containerName: client-container
              resource: limits.memory
          - path: "mem_request"
            resourceFieldRef:
              containerName: client-container
              resource: requests.memory
....</pre>
</div>
</div>
</div>
</div>
<div class="paragraph">
<p>If the resource limits are not included in the container configuration, the
downward API defaults to the node&#8217;s CPU and memory allocatable values.</p>
</div>
</li>
<li>
<p>Create the pod from the <code><strong><em>volume-pod.json</em></strong></code> file:</p>
<div class="exampleblock">
<div class="content">
<div class="listingblock">
<div class="content">
<pre>$ oc create -f volume-pod.json</pre>
</div>
</div>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div>
      </div>
    </div>
  </div>
  <script type="text/javascript">
    /*<![CDATA[*/
    $(document).ready(function() {
      $("[id^='topicGroup']").on('show.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicGroup']").on('hide.bs.collapse', function (event) {
        if (!($(event.target).attr('id').match(/^topicSubGroup/))) {
          $(this).parent().find("[id^='tgSpan']").toggleClass("fa-angle-right fa-angle-down");
        }
      });
      $("[id^='topicSubGroup']").on('show.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
      $("[id^='topicSubGroup']").on('hide.bs.collapse', function () {
        $(this).parent().find("[id^='sgSpan']").toggleClass("fa-caret-right fa-caret-down");
      });
    });
    /*]]>*/
  </script>
  <footer class="footer-digital-garage">
  <div class="container">
    <div class="row">
      <div class="col-xs-12 col-sm-4 col-md-3 logo">
        <a href="https://www.thedigitalgarage.io/"></a>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-6 text-center">
        <div class="row">
          <div class="col-xs-12 col-md-4">
            <a href="http://www.thedigitalgarage.io/community/digital-garage-privacy-policy/">
              Privacy Policy
            </a>
          </div>
          <div class="col-xs-12 col-md-4">
          <a href="http://www.thedigitalgarage.io/community/terms-of-service/">
            Terms of Use
          </a>
          </div>
          <div class="col-xs-12 col-md-4">
          <a href="http://www.thedigitalgarage.io/community/">
            Our Community
          </a>
          </div>
        </div>
      </div>
      <div class="col-xs-12 col-sm-4 col-md-3 text-right">
        <a id="built_with_asciibinder" href="http://asciibinder.org/">
          <img src="http://docs.thedigitalgarage.io/_images/asciibinder_web_logo.svg" alt="AsciiBinder" />
        </a>
      </div>
    </div>
  </div>
</footer>

<!-- Adobe DTM -->
<script type="text/javascript">
if (("undefined" !== typeof _satellite) && ("function" === typeof _satellite.pageBottom)) {
   _satellite.pageBottom();
}
</script>
<!-- End Adobe DTM -->
</body>
</html>